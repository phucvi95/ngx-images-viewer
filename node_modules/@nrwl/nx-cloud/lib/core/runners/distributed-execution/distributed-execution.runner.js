const a8_0x3607=['../../api/error-reporter.api','VERBOSE_LOGGING','logCommand','submitRunMetrics','./task-graph-creator','write','commandStatus','../../../utilities/waiter','copyFilesFromCache','NO_COMPLETED_TASKS_TIMEOUT','terminalOutput','createStartRequest','../../../utilities/create-unchanged-value-timeout','No\x20new\x20completed\x20tasks\x20after\x20','values','Command\x20execution\x20failed.','value','build','executionStatus:\x20','Waiter','COMPLETED','../../../utilities/nx-imports','printRunGroupError','scheduleTask','find','url','note','Distributed\x20Execution\x20Terminated','../../file-storage/e2e-encryption','../../../utilities/metric-logger','wait','../../error/print-run-group-error','apply','SIGINT','next','runUrl','configuration','DistributedExecutionApi','Extracting\x20artifacts','taskId','Found\x20unknown\x20task:\x20','\x20seconds.','error','retrieve','dependencies','run','targetDependencies','Processing\x20task\x20','get','serializeOverrides','ErrorReporterApi','number\x20of\x20completed\x20tasks:\x20','completedTasks','FileStorage','target','then','Error:','encryptionKey','E2EEncryption','TaskGraphCreator','nodes','success','join','throw','nxCloudDistributedTasksRunner','splitTasksIntoStages','/nx.json','See\x20run\x20details\x20at\x20','tasks','Successfully\x20completed\x20running\x20the\x20command.','./split-task-graph-into-stages','taskGraph','criticalErrorMessage','assign','strictlyOrderedTargets','toString','lifeCycle','Main\x20job\x20was\x20terminated\x20via\x20SIGTERM','done','Retrieving\x20artifacts\x20from\x20','push','createTaskGraph','hash','log','exit','defineProperty','executionStatus','ENCRYPTION_KEY','message','../../file-storage/file-storage','project','../../../utilities/serializer-overrides','SIGTERM','axiosException','completeRunGroupWithError','projectGraph','Unable\x20to\x20complete\x20a\x20run.'];(function(_0x2e8bb2,_0x36072a){const _0xabe0d3=function(_0x560c78){while(--_0x560c78){_0x2e8bb2['push'](_0x2e8bb2['shift']());}};_0xabe0d3(++_0x36072a);}(a8_0x3607,0x127));const a8_0xabe0=function(_0x2e8bb2,_0x36072a){_0x2e8bb2=_0x2e8bb2-0x0;let _0xabe0d3=a8_0x3607[_0x2e8bb2];return _0xabe0d3;};'use strict';var __awaiter=this&&this['__awaiter']||function(_0x56dfe0,_0x599c4b,_0x1e3a6e,_0x2cafb0){function _0x22dab2(_0xa2f227){return _0xa2f227 instanceof _0x1e3a6e?_0xa2f227:new _0x1e3a6e(function(_0x55a22d){_0x55a22d(_0xa2f227);});}return new(_0x1e3a6e||(_0x1e3a6e=Promise))(function(_0x189344,_0x337fb6){function _0x48240b(_0x33cdab){try{_0x3bc4f3(_0x2cafb0[a8_0xabe0('0x1e')](_0x33cdab));}catch(_0xa315b0){_0x337fb6(_0xa315b0);}}function _0x5289c2(_0x5a2b18){try{_0x3bc4f3(_0x2cafb0[a8_0xabe0('0x3b')](_0x5a2b18));}catch(_0x203d22){_0x337fb6(_0x203d22);}}function _0x3bc4f3(_0xc51ea9){_0xc51ea9[a8_0xabe0('0x4a')]?_0x189344(_0xc51ea9['value']):_0x22dab2(_0xc51ea9[a8_0xabe0('0xc')])[a8_0xabe0('0x33')](_0x48240b,_0x5289c2);}_0x3bc4f3((_0x2cafb0=_0x2cafb0[a8_0xabe0('0x1c')](_0x56dfe0,_0x599c4b||[]))[a8_0xabe0('0x1e')]());});};Object[a8_0xabe0('0x51')](exports,'__esModule',{'value':!![]});exports[a8_0xabe0('0x3c')]=void 0x0;const fs_1=require('fs');const stripJsonComments=require('strip-json-comments');const create_unchanged_value_timeout_1=require(a8_0xabe0('0x8'));const environment_1=require('../../../utilities/environment');const metric_logger_1=require(a8_0xabe0('0x19'));const serializer_overrides_1=require(a8_0xabe0('0x57'));const waiter_1=require(a8_0xabe0('0x3'));const error_reporter_api_1=require(a8_0xabe0('0x5d'));const print_run_group_error_1=require(a8_0xabe0('0x1b'));const e2e_encryption_1=require(a8_0xabe0('0x18'));const file_storage_1=require(a8_0xabe0('0x55'));const distributed_execution_api_1=require('./distributed-execution.api');const split_task_graph_into_stages_1=require(a8_0xabe0('0x42'));const task_graph_creator_1=require(a8_0xabe0('0x0'));const {output,workspaceRoot,getOutputs,Cache}=require(a8_0xabe0('0x11'));class NoopLifeCycle{[a8_0xabe0('0x13')](_0x3acd79){}['startTask'](_0x1d0003){}['endTask'](_0x51985c,_0x2b9d08){}}function runDistributedExecution(_0x4677cf,_0x553e2c,_0x1ef5d4,_0x3868c6,_0x447811,_0x3de93d,_0x3d2ca1){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x55cc7d=yield _0x4677cf['start']((0x0,distributed_execution_api_1[a8_0xabe0('0x7')])(_0x3de93d,(0x0,split_task_graph_into_stages_1[a8_0xabe0('0x3d')])(_0x3d2ca1),_0x553e2c));return yield processTasks(_0x4677cf,_0x3868c6,_0x447811,_0x553e2c,_0x55cc7d,Object[a8_0xabe0('0xa')](_0x3d2ca1[a8_0xabe0('0x40')]),_0x1ef5d4);});}function processTasks(_0x33002a,_0x1563a1,_0x4e63bd,_0x548057,_0x19fe5c,_0x350d7c,_0xf87c9d){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2572c4={};const _0x50ced4=(0x0,create_unchanged_value_timeout_1['createUnchangedValueTimeout'])({'title':a8_0xabe0('0x9')+environment_1[a8_0xabe0('0x5')]/0x3e8+a8_0xabe0('0x25'),'timeout':environment_1['NO_COMPLETED_TASKS_TIMEOUT']});const _0x3b2d20=new waiter_1[(a8_0xabe0('0xf'))]();while(!![]){if(environment_1[a8_0xabe0('0x5e')]){output[a8_0xabe0('0x16')]({'title':'Waiting...'});}yield _0x3b2d20[a8_0xabe0('0x1a')]();const _0x1fa9f5=yield _0x33002a['status'](_0x19fe5c);if(environment_1[a8_0xabe0('0x5e')]){output[a8_0xabe0('0x16')]({'title':'Status\x20update','bodyLines':['executionId:\x20'+_0x19fe5c,a8_0xabe0('0xe')+_0x1fa9f5[a8_0xabe0('0x52')],a8_0xabe0('0x2f')+_0x1fa9f5['completedTasks']['length'],'error:\x20'+_0x1fa9f5[a8_0xabe0('0x44')]]});}if(_0x1fa9f5['criticalErrorMessage']){output[a8_0xabe0('0x26')]({'title':a8_0xabe0('0x17'),'bodyLines':[a8_0xabe0('0x34'),_0x1fa9f5[a8_0xabe0('0x44')]]});process[a8_0xabe0('0x50')](0x1);}_0x50ced4(_0x1fa9f5['completedTasks']['length']);for(const _0x42154f of _0x1fa9f5[a8_0xabe0('0x30')]){if(_0x2572c4[_0x42154f[a8_0xabe0('0x23')]])continue;yield processTask(_0x1563a1,_0x4e63bd,_0xf87c9d,_0x548057,_0x350d7c,_0x42154f);_0x3b2d20['reset']();_0x2572c4[_0x42154f[a8_0xabe0('0x23')]]=!![];}if(_0x1fa9f5[a8_0xabe0('0x52')]===a8_0xabe0('0x10')){return{'commandStatus':_0x1fa9f5['commandStatus'],'runUrl':_0x1fa9f5[a8_0xabe0('0x1f')]};}}});}function processTask(_0x4a7a98,_0x1a6b1b,_0x371c9e,_0x1a5776,_0x39201d,_0x5b0012){return __awaiter(this,void 0x0,void 0x0,function*(){if(environment_1[a8_0xabe0('0x5e')]){output[a8_0xabe0('0x16')]({'title':a8_0xabe0('0x2b')+_0x5b0012[a8_0xabe0('0x23')]});}const _0x34d691=_0x39201d[a8_0xabe0('0x14')](_0x11f68d=>_0x5b0012[a8_0xabe0('0x23')]===_0x11f68d['id']);if(!_0x34d691){throw new Error(a8_0xabe0('0x24')+_0x5b0012[a8_0xabe0('0x23')]);}if(environment_1[a8_0xabe0('0x5e')]){output[a8_0xabe0('0x16')]({'title':a8_0xabe0('0x4b')+_0x5b0012['url']});}yield _0x4a7a98[a8_0xabe0('0x27')](_0x5b0012[a8_0xabe0('0x4e')],_0x5b0012[a8_0xabe0('0x15')],_0x1a5776['cacheDirectory']||'./node_modules/.cache/nx');const _0x97b55f=yield _0x1a6b1b[a8_0xabe0('0x2c')](Object['assign'](Object[a8_0xabe0('0x45')]({},_0x34d691),{'hash':_0x5b0012[a8_0xabe0('0x4e')]}));const _0x31d5f1=getOutputs(_0x371c9e[a8_0xabe0('0x5b')][a8_0xabe0('0x38')],_0x34d691);if(environment_1[a8_0xabe0('0x5e')]){output[a8_0xabe0('0x16')]({'title':a8_0xabe0('0x22'),'bodyLines':_0x31d5f1});}yield _0x1a6b1b[a8_0xabe0('0x4')](_0x5b0012[a8_0xabe0('0x4e')],_0x97b55f,_0x31d5f1);output[a8_0xabe0('0x5f')](getCommand(_0x34d691));process['stdout'][a8_0xabe0('0x1')](_0x97b55f[a8_0xabe0('0x6')]);output['addVerticalSeparator']();});}function getCommand(_0x7c30){const _0x3b8a98=_0x7c30[a8_0xabe0('0x32')][a8_0xabe0('0x20')]?':'+_0x7c30[a8_0xabe0('0x32')][a8_0xabe0('0x20')]:'';return['nx',a8_0xabe0('0x29'),_0x7c30['target'][a8_0xabe0('0x56')]+':'+_0x7c30[a8_0xabe0('0x32')][a8_0xabe0('0x32')]+_0x3b8a98,(0x0,serializer_overrides_1[a8_0xabe0('0x2d')])(_0x7c30)][a8_0xabe0('0x3a')]('\x20');}function attachSignalListenersToCompleteRunGroupOnError(_0xdcd200,_0x37bd82){process['on'](a8_0xabe0('0x1d'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0xdcd200[a8_0xabe0('0x5a')](_0x37bd82,'Main\x20job\x20was\x20terminated\x20via\x20SIGINT');process[a8_0xabe0('0x50')](0x1);}));process['on'](a8_0xabe0('0x58'),()=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0xdcd200[a8_0xabe0('0x5a')](_0x37bd82,a8_0xabe0('0x49'));process[a8_0xabe0('0x50')](0x1);}));}const nxCloudDistributedTasksRunner=(_0x21e129,_0x21d772,_0x232c79)=>__awaiter(void 0x0,void 0x0,void 0x0,function*(){if(environment_1['VERBOSE_LOGGING']){output['note']({'title':'Starting\x20distributed\x20command\x20execution'});}_0x21d772[a8_0xabe0('0x48')]=new NoopLifeCycle();const _0x3e70f1=(0x0,environment_1['getRunGroup'])();if(!_0x3e70f1){(0x0,print_run_group_error_1[a8_0xabe0('0x12')])();return process['exit'](0x1);}const _0x190ee6=new e2e_encryption_1[(a8_0xabe0('0x36'))](environment_1[a8_0xabe0('0x53')]||_0x21d772[a8_0xabe0('0x35')]);const _0x1c1c21=new error_reporter_api_1[(a8_0xabe0('0x2e'))](_0x21d772);const _0xcf5c49=new file_storage_1[(a8_0xabe0('0x31'))](_0x190ee6,_0x1c1c21,!![],![]);const _0x4a98db=new Cache(_0x21d772);const _0x45651e=new distributed_execution_api_1[(a8_0xabe0('0x21'))](_0x21d772);attachSignalListenersToCompleteRunGroupOnError(_0x45651e,_0x3e70f1);try{const _0x794e01=getTaskGraph(_0x232c79,_0x21e129,_0x21d772);const _0x4d9f0b=yield runDistributedExecution(_0x45651e,_0x21d772,_0x232c79,_0xcf5c49,_0x4a98db,_0x3e70f1,_0x794e01);if(_0x4d9f0b[a8_0xabe0('0x2')]===0x0){output[a8_0xabe0('0x39')]({'title':a8_0xabe0('0x41'),'bodyLines':[a8_0xabe0('0x3f')+_0x4d9f0b[a8_0xabe0('0x1f')]]});}else{output['error']({'title':a8_0xabe0('0xb'),'bodyLines':[a8_0xabe0('0x3f')+_0x4d9f0b['runUrl']]});}yield(0x0,metric_logger_1[a8_0xabe0('0x60')])(_0x21d772);process[a8_0xabe0('0x50')](_0x4d9f0b[a8_0xabe0('0x2')]);}catch(_0x163f8b){output['error']({'title':a8_0xabe0('0x5c'),'bodyLines':[_0x163f8b['message']]});if(_0x163f8b[a8_0xabe0('0x59')]){console[a8_0xabe0('0x4f')](_0x163f8b[a8_0xabe0('0x59')]);}else{console[a8_0xabe0('0x4f')](_0x163f8b);}try{yield _0x45651e[a8_0xabe0('0x5a')](_0x3e70f1,'Main\x20job\x20terminated\x20with\x20an\x20error:\x20\x22'+_0x163f8b[a8_0xabe0('0x54')]+'\x22');}finally{process[a8_0xabe0('0x50')](0x1);}}});exports[a8_0xabe0('0x3c')]=nxCloudDistributedTasksRunner;function getTaskGraph(_0x4a51c3,_0x11c5f3,_0x18fd02){if(_0x4a51c3[a8_0xabe0('0x43')]){return _0x4a51c3[a8_0xabe0('0x43')];}else{const _0xc0a7cc=JSON['parse'](stripJsonComments((0x0,fs_1['readFileSync'])(workspaceRoot+a8_0xabe0('0x3e'))[a8_0xabe0('0x47')]()));return new task_graph_creator_1[(a8_0xabe0('0x37'))](_0x4a51c3[a8_0xabe0('0x5b')],getDefaultDependencyConfigs(_0xc0a7cc,_0x18fd02))[a8_0xabe0('0x4d')](_0x11c5f3);}}function getDefaultDependencyConfigs(_0x23089d,_0x14f237){var _0x1274a8,_0xf1a72a;const _0x1ce27d=(_0x1274a8=_0x23089d[a8_0xabe0('0x2a')])!==null&&_0x1274a8!==void 0x0?_0x1274a8:{};const _0x404a7d=_0x14f237?(_0xf1a72a=_0x14f237[a8_0xabe0('0x46')])!==null&&_0xf1a72a!==void 0x0?_0xf1a72a:[a8_0xabe0('0xd')]:[];for(const _0x47f3e7 of _0x404a7d){_0x1ce27d[_0x47f3e7]=_0x1ce27d[_0x47f3e7]||[];_0x1ce27d[_0x47f3e7][a8_0xabe0('0x4c')]({'target':_0x47f3e7,'projects':a8_0xabe0('0x28')});}return _0x1ce27d;}